<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="782px" preserveAspectRatio="none" style="width:1215px;height:782px;background:#FEFEFE;" version="1.1" viewBox="0 0 1215 782" width="1215px" zoomAndPan="magnify"><defs><filter height="300%" id="fee0ym7x3azkk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="126" x="542.5" y="30.6855">関数処理フロー</text><rect fill="#FFFFFF" filter="url(#fee0ym7x3azkk)" height="73.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="447.5" y="123.6016"/><rect fill="#FFFFFF" filter="url(#fee0ym7x3azkk)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="447.5" y="271.0078"/><rect fill="#FFFFFF" filter="url(#fee0ym7x3azkk)" height="281.5156" style="stroke:#A80036;stroke-width:1.0;" width="10" x="773" y="417.7656"/><rect fill="#FEFEFE" filter="url(#fee0ym7x3azkk)" height="330.2188" style="stroke:#000000;stroke-width:2.0;" width="1191" x="10" y="377.0625"/><rect fill="#FEFEFE" filter="url(#fee0ym7x3azkk)" height="174.1094" style="stroke:#000000;stroke-width:2.0;" width="1171" x="20" y="463.1172"/><rect fill="#FEFEFE" height="125.4063" style="stroke:none;stroke-width:1.0;" width="1171" x="20" y="511.8203"/><rect fill="#FEFEFE" filter="url(#fee0ym7x3azkk)" height="48.7031" style="stroke:#000000;stroke-width:2.0;" width="467.5" x="713.5" y="551.1719"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="74" x2="74" y1="91.25" y2="724.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="452" x2="452" y1="91.25" y2="724.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="663.5" x2="663.5" y1="91.25" y2="724.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="777.5" x2="777.5" y1="91.25" y2="724.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1054" x2="1054" y1="91.25" y2="724.2813"/><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="85" x="30" y="54.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="37" y="76.1738">subSample</text><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="85" x="30" y="723.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="37" y="744.8145">subSample</text><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="105" x="398" y="54.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="405" y="76.1738">funcSample01</text><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="105" x="398" y="723.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="405" y="744.8145">funcSample01</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="613.5" y="88.1738">FilePathシート</text><ellipse cx="663.5" cy="57.6406" fill="#FEFECE" filter="url(#fee0ym7x3azkk)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="651.5" x2="675.5" y1="71.6406" y2="71.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="613.5" y="737.8145">FilePathシート</text><ellipse cx="663.5" cy="756.8906" fill="#FEFECE" filter="url(#fee0ym7x3azkk)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="651.5" x2="675.5" y1="770.8906" y2="770.8906"/><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="105" x="723.5" y="54.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="730.5" y="76.1738">funcSample02</text><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="105" x="723.5" y="723.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="730.5" y="744.8145">funcSample02</text><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="230" x="937" y="54.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="944" y="76.1738">ファイルパスの指す各Excelブック</text><rect fill="#FEFECE" filter="url(#fee0ym7x3azkk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="230" x="937" y="723.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="944" y="744.8145">ファイルパスの指す各Excelブック</text><rect fill="#FFFFFF" filter="url(#fee0ym7x3azkk)" height="73.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="447.5" y="123.6016"/><rect fill="#FFFFFF" filter="url(#fee0ym7x3azkk)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="447.5" y="271.0078"/><rect fill="#FFFFFF" filter="url(#fee0ym7x3azkk)" height="281.5156" style="stroke:#A80036;stroke-width:1.0;" width="10" x="773" y="417.7656"/><polygon fill="#A80036" points="435.5,119.6016,445.5,123.6016,435.5,127.6016,439.5,123.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74.5" x2="441.5" y1="123.6016" y2="123.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="81.5" y="118.7451">存在しないシートを引数として呼び出す</text><line style="stroke:#A80036;stroke-width:1.0;" x1="457.5" x2="499.5" y1="153.9531" y2="153.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="499.5" x2="499.5" y1="153.9531" y2="166.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="458.5" x2="499.5" y1="166.9531" y2="166.9531"/><polygon fill="#A80036" points="468.5,162.9531,458.5,166.9531,468.5,170.9531,464.5,166.9531" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="464.5" y="149.0967">エラーの発生</text><polygon fill="#A80036" points="85.5,193.3047,75.5,197.3047,85.5,201.3047,81.5,197.3047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="79.5" x2="451.5" y1="197.3047" y2="197.3047"/><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="91.5" y="192.4482">Nullの返却</text><line style="stroke:#A80036;stroke-width:1.0;" x1="74.5" x2="116.5" y1="227.6563" y2="227.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="116.5" x2="116.5" y1="227.6563" y2="240.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="75.5" x2="116.5" y1="240.6563" y2="240.6563"/><polygon fill="#A80036" points="85.5,236.6563,75.5,240.6563,85.5,244.6563,81.5,240.6563" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="364" x="81.5" y="222.7998">「ファイルパス配列の取得に失敗しました」メッセージの表示</text><polygon fill="#A80036" points="435.5,267.0078,445.5,271.0078,435.5,275.0078,439.5,271.0078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74.5" x2="441.5" y1="271.0078" y2="271.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="81.5" y="266.1514">FilePathシートの名前を引数として呼び出す</text><polygon fill="#A80036" points="651.5,297.3594,661.5,301.3594,651.5,305.3594,655.5,301.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="457.5" x2="657.5" y1="301.3594" y2="301.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="464.5" y="296.5029">シートのセルの参照</text><polygon fill="#A80036" points="468.5,327.7109,458.5,331.7109,468.5,335.7109,464.5,331.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="462.5" x2="662.5" y1="331.7109" y2="331.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="474.5" y="326.8545">ファイルパス文字列配列の取得</text><polygon fill="#A80036" points="85.5,358.0625,75.5,362.0625,85.5,366.0625,81.5,362.0625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="79.5" x2="451.5" y1="362.0625" y2="362.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="91.5" y="357.2061">ファイルパス文字列配列の返却</text><path d="M10,377.0625 L83,377.0625 L83,385.0625 L73,395.0625 L10,395.0625 L10,377.0625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="330.2188" style="stroke:#000000;stroke-width:2.0;" width="1191" x="10" y="377.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="25" y="391.5576">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="129" x="98" y="390.4814">[それぞれのファイルパス]</text><polygon fill="#A80036" points="761,413.7656,771,417.7656,761,421.7656,765,417.7656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74.5" x2="767" y1="417.7656" y2="417.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="81.5" y="412.9092">ファイルパスを渡す</text><polygon fill="#A80036" points="1042,444.1172,1052,448.1172,1042,452.1172,1046,448.1172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="783" x2="1048" y1="448.1172" y2="448.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="790" y="443.2607">Excelブックを開く</text><path d="M20,463.1172 L80,463.1172 L80,471.1172 L70,481.1172 L20,481.1172 L20,463.1172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="174.1094" style="stroke:#000000;stroke-width:2.0;" width="1171" x="20" y="463.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="35" y="477.6123">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="231" x="95" y="476.5361">[すでにA1セルに文字が書き込まれていた場合]</text><polygon fill="#A80036" points="85.5,499.8203,75.5,503.8203,85.5,507.8203,81.5,503.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="79.5" x2="772" y1="503.8203" y2="503.8203"/><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="91.5" y="498.9639">カスタムエラーを発火させる</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1191" y1="512.8203" y2="512.8203"/><polygon fill="#A80036" points="1042,532.1719,1052,536.1719,1042,540.1719,1046,536.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="783" x2="1048" y1="536.1719" y2="536.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="790" y="531.3154">一枚目シートのA1に時刻を書き込み</text><path d="M713.5,551.1719 L778.5,551.1719 L778.5,559.1719 L768.5,569.1719 L713.5,569.1719 L713.5,551.1719 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="48.7031" style="stroke:#000000;stroke-width:2.0;" width="467.5" x="713.5" y="551.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="728.5" y="565.667">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="129" x="793.5" y="564.5908">[二枚目シートが存在する]</text><polygon fill="#A80036" points="1042,587.875,1052,591.875,1042,595.875,1046,591.875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="783" x2="1048" y1="591.875" y2="591.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="790" y="587.0186">二枚目シートのA1に「完了」と書き込む</text><polygon fill="#A80036" points="1042,625.2266,1052,629.2266,1042,633.2266,1046,629.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="783" x2="1048" y1="629.2266" y2="629.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="790" y="624.3701">シートの保存</text><polygon fill="#A80036" points="1042,695.2813,1052,699.2813,1042,703.2813,1046,699.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="778" x2="1048" y1="699.2813" y2="699.2813"/><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="785" y="661.7217">ブックを閉じる</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="785" y="678.0732">正常終了時でもエラーが起きた場合でも、</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="785" y="694.4248">必ず実行される</text><!--MD5=[fdb6593ec7f87caa6de7b1b1af15ca4f]
@startuml

skinparam{
    BackgroundColor #fefefe
}

title 関数処理フロー
participant subSample
participant funcSample01
entity FilePathシート as FPSt
participant funcSample02
participant ファイルパスの指す各Excelブック as WB


subSample -> funcSample01: 存在しないシートを引数として呼び出す
activate funcSample01
funcSample01 -> funcSample01: エラーの発生
funcSample01 - -> subSample: <color:#118888>Nullの返却
deactivate funcSample01
subSample -> subSample: 「ファイルパス配列の取得に失敗しました」メッセージの表示

subSample -> funcSample01: FilePathシートの名前を引数として呼び出す
activate funcSample01
funcSample01 -> FPSt: シートのセルの参照
FPSt - -> funcSample01: ファイルパス文字列配列の取得
funcSample01 - -> subSample: ファイルパス文字列配列の返却
deactivate funcSample01

loop それぞれのファイルパス
    subSample -> funcSample02: ファイルパスを渡す
    activate funcSample02
    funcSample02 -> WB: Excelブックを開く
    alt すでにA1セルに文字が書き込まれていた場合
        funcSample02 -> subSample: <color:#118888>カスタムエラーを発火させる
    else
    funcSample02 -> WB: 一枚目シートのA1に時刻を書き込み
    opt 二枚目シートが存在する
        funcSample02 -> WB: 二枚目シートのA1に「完了」と書き込む
    end
    funcSample02 -> WB: シートの保存
    end
    funcSample02 -> WB: <color:#118888>ブックを閉じる\n<color:#118888>正常終了時でもエラーが起きた場合でも、\n<color:#118888>必ず実行される
    deactivate funcSample02
end


@enduml

PlantUML version 1.2022.0(Wed Jan 12 01:16:42 JST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>