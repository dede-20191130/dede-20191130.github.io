---
title: "[教えて！VBA] 第3回 Accessマクロで、テーブルのデータを全クリアするにはどうすればいいの？？"
author: dede-20191130
date: 2021-12-25T09:57:26+09:00
slug: vba-question-003-clear-data-in-table
draft: false
toc: true
featured: false
tags: ["VBA","Access"]
categories: ["プログラミング"]
archives:
    - 2021
    - 2021-12
---

## この記事について

{{< box-with-title title="かんたんな概要と結論" >}} 
    テーブルデータクリアには、作成済みクエリ経由とSQL経由の二通りがありますが、<br>
    内部で行っていることはさほど違いがありません。<br><br>
    注意点として、テーブル削除と混同しないようにすることがあります。
{{< /box-with-title >}}

こんにちは、dedeです。

この記事では、  
VBAマクロに関する質問のうち、  
皆が疑問に思っているトピックについて解説いたします。

今回は、
{{< colored-span color="#fb9700" >}}Accessマクロで、テーブルのデータを全クリアする方法{{< /colored-span >}}  
を解説いたします。

※この記事は、Office VBAマクロのうち  
Access VBAマクロに関するトピックです。

レベル：<b>初級者向け</b>


## 注意：テーブルデータクリアとテーブル削除の違い

最初に気をつけなければならないのは、  
「テーブルのデータ全クリア」と「テーブル削除」という  
２つの紛らわしい概念を整理しなければならないということです。

似ているけれど、この２つの意味するところは違います。

テーブルのデータ全クリアはデータ（レコード）自体は削除しますが、  
テーブル構造やメタデータ（メタデータについては後述）は残ります。  

一方、テーブル削除は  
テーブルそのものを削除するため、テーブル構造やメタデータも失われ、  
テーブルの再度の利用はできなくなります。  

そのため、使用しないテーブルや一時的に利用するだけに動的に作成したテーブルなどは、  
テーブルのデータクリアよりもテーブル削除のほうが適しており、  
それ以外はテーブルデータクリアのほうが安全かと思われます。

![テーブルデータクリアとテーブル削除の違い](https://res.cloudinary.com/ddxhi1rnh/image/upload/v1640415368/learnerBlog/vba-question-003-clear-data-in-table/clear-and-delete_rqstxu.png)

※メタデータについて  
ここでいうテーブルのメタデータとは、  
本体であるデータ（レコード）に関する付帯情報のことで、  
テーブル作成日時、更新日時、各フィールドについての説明文章などが該当します。


## テーブルデータクリアの方法

クリアの方法には  
大きく分けてクエリ経由とSQL経由の二種類があります。

### アクションクエリを作成して呼び出す

アクションクエリを作成後にVBAで呼び出してクリアする方法について説明します。

【アクションクエリとは】  
テーブルの中のデータを操作するクエリを指します。  
「データ登録、読み取り、更新、削除」をするクエリが含まれます。

一方で、テーブルのフィールドを変更したり、  
テーブルを新規作成したりするクエリは「データ定義クエリ」と呼びます。

#### 準備

①新規クエリを作成する


「クエリデザイン」ボタンを押下し、  
クエリ作成画面を表示します。

![「クエリデザイン」ボタンを押下](https://res.cloudinary.com/ddxhi1rnh/image/upload/v1640415380/learnerBlog/vba-question-003-clear-data-in-table/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2021-12-25_113715_owxdms.png)

データクリアしたいテーブルをポップアップから選択します。

![テーブルの選択](https://res.cloudinary.com/ddxhi1rnh/image/upload/v1640415381/learnerBlog/vba-question-003-clear-data-in-table/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2021-12-25_113751_ucm2xd.png)

②削除クエリとして設定し、保存する

上部の「クエリデザインタブ」から  
削除ボタンを押下します。

![削除クエリを選択](https://res.cloudinary.com/ddxhi1rnh/image/upload/v1640415382/learnerBlog/vba-question-003-clear-data-in-table/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2021-12-25_113813_nxhaxz.png)

任意の名前をつけて保存します。

#### 実行

次のように、  
作成したクエリの名前を引数として、  
データクリア命令を実行します。

```vb
Sub クエリを利用したテーブルクリア関数()
    CurrentDb.Execute "削除クエリサンプル"
End Sub
```


### SQLでクリアコードを記述して実行する

SQL（データベースを操作するための標準化された言語）を使用することでも  
目的を実現することができます。

レコード削除するためのSQL命令文は、  
`DELETE FROM`構文です。

```sql
DELETE FROM TABLE_NAME
```

これをVBAで実行するには、  
次のようにします。

```vb
Sub SQLを利用したテーブルクリア関数()
    CurrentDb.Execute "DELETE FROM サンプルテーブル"
End Sub
```


### 実はやっていることは同じ？

これまで説明した２通りの方法は、  
実は内部でやっている事はだいたい同じです。

クエリを開き、  
右下のSQLタブを選択すると……

![SQLタブの選択](https://res.cloudinary.com/ddxhi1rnh/image/upload/v1640415384/learnerBlog/vba-question-003-clear-data-in-table/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2021-12-25_152209_adktpk.png)

クエリの実行内容として登録されている  
SQLコードの内容が表示されます。

![SQLコードの内容](https://res.cloudinary.com/ddxhi1rnh/image/upload/v1640415385/learnerBlog/vba-question-003-clear-data-in-table/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2021-12-25_152301_hz5jgj.png)

つまり、アクションクエリ作成のUIから作成しても、  
実行するSQLは同じです。

違いとしては、  
一度クエリを作成し、実行した場合、  
内部でクエリ内容がコンパイルされ、  
二度目以降の実行速度が改善するようです。

## おまけ：テーブル削除をする方法

おまけとして、  
データ全クリアではなくテーブル削除をする方も説明したいと思います。

### 組み込みアクションで実現

組み込みアクション（あらかじめAccessで作成済みのアクション）でテーブル削除するには、  
`DoCmd`モジュールに含まれる`DeleteObject`メソッドを使用します。

```vb
DoCmd.DeleteObject acTable, "サンプルテーブル"
```

### SQLで実現

組み込みの関数を使用せずに自分でコードを書く場合、  
SQLの`DROP TABLE`構文を利用します。

```vb
CurrentDb.Execute "DROP TABLE サンプルテーブル"
```

## 終わりに

データクリア命令とテーブル削除命令を混同しないようにして、  
利用環境に合わせてクエリでもSQLでも自在にデータ操作を書けるようにすれば、  
Access利用の幅が広がるでしょう。




